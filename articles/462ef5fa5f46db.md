---
title: "MinIOã‚’å°å…¥ã—ã¦ã¿ã‚‹(ã‚ªãƒ³ãƒ—ãƒ¬)"
emoji: "ğŸ¡"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["minio"]
published: false
---

# ã¯ã˜ã‚ã«

MinIO ã¯ã€Amazon S3 äº’æ›ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚µãƒ¼ãƒãƒ¼ã§ã‚ã‚‹ã€‚

[https://min.io/](https://min.io/)

MinIO ã¯ S3 ã¨äº’æ›æ€§ã‚’æŒã¡ã€AWS SDK ã‚’é€šã˜ã¦ã‚¢ã‚¯ã‚»ã‚¹ãƒ»æ“ä½œãŒå¯èƒ½ã§ã‚ã‚‹ã€‚

MinIO ã«ã¯ã€Docker Image ãŒå…¬å¼ã‹ã‚‰æä¾›ã•ã‚Œã¦ã„ã‚‹ã€‚  
[https://hub.docker.com/r/minio/minio/](https://hub.docker.com/r/minio/minio/)

ãŸã ã—ã€ã“ã“ã§ã¯æ§‹æˆè¦ç´ ã®ç¢ºèªã‚‚å…¼ã­ã¦ã€ä»®æƒ³ã‚µãƒ¼ãƒã¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’è©¦ã¿ã‚‹ã€‚  
ãªãŠã€Dockerã«ã‚ˆã‚‹ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¯ã€ä»¥ä¸‹ã®è¨˜äº‹ãŒå‚è€ƒã«ãªã‚‹ã€‚

- [[MinIO]boto3ã§æ“ä½œå¯èƒ½ãªS3äº’æ›ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ä¸Šã«Docker Composeã§ç«‹ã¦ã‚‹æ–¹æ³•](https://dev.classmethod.jp/articles/minio-docker-compose/)
- [MinIO ã‚’ä½¿ã£ã¦ãƒ­ãƒ¼ã‚«ãƒ«ã§ã®é–‹ç™ºç’°å¢ƒã®å¤–éƒ¨ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚’ Amazon S3 ã‹ã‚‰ãƒ­ãƒ¼ã‚«ãƒ«ã®ã‚³ãƒ³ãƒ†ãƒŠã¸ç½®ãæ›ãˆã‚‹](https://www.ritolab.com/posts/232)

# åŸºæœ¬æ–¹é‡

ä»Šå›ã¯Ubuntuã«ç›´æ¥ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚

å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®[Install and Deploy MinIO](https://min.io/docs/minio/linux/operations/installation.html)ã«ã‚ˆã‚‹ã¨ã€ä»¥ä¸‹ã®æ§‹æˆãŒæƒ³å®šã•ã‚Œã¦ã„ã‚‹ã€‚

- Single-Node Single-Drive (SNSD or â€œStandaloneâ€)
- Single-Node Multi-Drive (SNMD or â€œStandalone Multi-Driveâ€)
- Multi-Node Multi-Drive (MNMD or â€œDistributedâ€)

ä»Šå›ã¯æ¤œè¨¼çš„ãªæ„å‘³ã‚‚è¾¼ã‚ã¦ã€[Single-Node Single-Drive](https://min.io/docs/minio/linux/operations/install-deploy-manage/deploy-minio-single-node-single-drive.html#minio-snsd)ã®æ‰‹é †ã«å¾“ã„ã€å°å…¥ã‚’è¡Œã†ã€‚

# MinIOã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

## 1) Download the MinIO Server

debãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’wgetã«ã‚ˆã‚Šå–å¾—ã—ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’è¡Œã†ã€‚  
ä»¥ä¸‹ã®URLã¯ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒç›´æ¥æŒ‡å®šã•ã‚Œã¦ã„ã‚‹ãŒã€éƒ½åº¦å¤‰ã‚ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ã€ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã¨ã‚ˆã„ã€‚

```bash:terminal
wget https://dl.min.io/server/minio/release/linux-amd64/archive/minio_20230102094009.0.0_amd64.deb -O minio.deb
sudo dpkg -i minio.deb
```

## 2) systemdã‚µãƒ¼ãƒ“ã‚¹ã¸ã®ç™»éŒ²

systemdã‚µãƒ¼ãƒ“ã‚¹åŒ–ã®ãŸã‚ã€`/etc/systemd/system/minio.service`ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ–°è¦ä½œæˆã™ã‚‹ã€‚

```bash:terminal
vi /etc/systemd/system/minio.service
```

ä»¥ä¸‹ã®å†…å®¹ã‚’ã¹ãŸè²¼ã‚Šã™ã‚Œã°ã‚ˆã„ã€‚

```
[Unit]
Description=MinIO
Documentation=https://min.io/docs/minio/linux/index.html
Wants=network-online.target
After=network-online.target
AssertFileIsExecutable=/usr/local/bin/minio

[Service]
WorkingDirectory=/usr/local

User=minio-user
Group=minio-user
ProtectProc=invisible

EnvironmentFile=-/etc/default/minio
ExecStartPre=/bin/bash -c "if [ -z \"${MINIO_VOLUMES}\" ]; then echo \"Variable MINIO_VOLUMES not set in /etc/default/minio\"; exit 1; fi"
ExecStart=/usr/local/bin/minio server $MINIO_OPTS $MINIO_VOLUMES

# Let systemd restart this service always
Restart=always

# Specifies the maximum file descriptor number that can be opened by this process
LimitNOFILE=65536

# Specifies the maximum number of threads this process can create
TasksMax=infinity

# Disable timeout logic and wait until process is stopped
TimeoutStopSec=infinity
SendSIGKILL=no

[Install]
WantedBy=multi-user.target

# Built for ${project.name}-${project.version} (${project.name})
```

minioã‚µãƒ¼ãƒ“ã‚¹ã«åˆã‚ã›ãŸãƒ¦ãƒ¼ã‚¶ã¨ã‚°ãƒ«ãƒ¼ãƒ—ã®è¨­å®šã‚’è¡Œã†ã€‚  
ãªãŠã€ãƒ‰ãƒ©ã‚¤ãƒ–ãƒ‘ã‚¹ã®æŒ‡å®šã¯ä¾‹ã¨ã—ã¦ä¸ãˆãŸã‚‚ã®ã§ã‚ã‚Šã€MinIOã§ä½¿ç”¨ã™ã‚‹ãƒ‰ãƒ©ã‚¤ãƒ–ã®ãƒ‘ã‚¹ã¨ä¸€è‡´ã™ã‚‹ã‚ˆã†ã«å¤‰æ›´ã™ã‚‹ã€‚

```bash:terminal
groupadd -r minio-user
useradd -M -r -g minio-user minio-user
chown minio-user:minio-user /mnt/disk1 /mnt/disk2 /mnt/disk3 /mnt/disk4
```

MinIOã¯ã€ãã®ä»–ã®èµ·å‹•ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ä¾‹ã‚’[github.com/minio/minio-service](github.com/minio/minio-service)ã§å…¬é–‹ã—ã¦ã„ã‚‹ã€‚


## 3) Create the Environment Variable File

`/etc/default/minio` ã«ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹ã€‚
MinIO Server ã‚³ãƒ³ãƒ†ãƒŠã¯ã€ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã™ã¹ã¦ã®ç’°å¢ƒå¤‰æ•°ã®ã‚½ãƒ¼ã‚¹ã¨ã—ã¦ä½¿ç”¨ã§ãã‚‹ã€‚

æ¬¡ã®ä¾‹ã¯ã€é–‹å§‹ç’°å¢ƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚

```
# MINIO_ROOT_USER and MINIO_ROOT_PASSWORD sets the root account for the MinIO server.
# This user has unrestricted permissions to perform S3 and administrative API operations on any resource in the deployment.
# Omit to use the default values 'minioadmin:minioadmin'.
# MinIO recommends setting non-default values as a best practice, regardless of environment

MINIO_ROOT_USER=myminioadmin
MINIO_ROOT_PASSWORD=minio-secret-key-change-me

# MINIO_VOLUMES sets the storage volume or path to use for the MinIO server.

MINIO_VOLUMES="/mnt/data"

# MINIO_SERVER_URL sets the hostname of the local machine for use with the MinIO Server
# MinIO assumes your network control plane can correctly resolve this hostname to the local machine

# Uncomment the following line and replace the value with the correct hostname for the local machine.

#MINIO_SERVER_URL="http://minio.example.net"
```

ãƒ­ãƒ¼ã‚«ãƒ«ã§ã®å±•é–‹ã«å¿…è¦ãªãã®ä»–ã®ç’°å¢ƒå¤‰æ•°ã‚‚å«ã‚ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚

## 4) Start the MinIO Service

4) MinIOã‚µãƒ¼ãƒ“ã‚¹ã®é–‹å§‹

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã€MinIO SNSD ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã‚’ã‚µãƒ¼ãƒ“ã‚¹ã¨ã—ã¦é–‹å§‹ã—ã¾ã™ã€‚

```bash:terminal
sudo systemctl start minio.service
```

æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã€ã‚µãƒ¼ãƒ“ã‚¹ãŒã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã§ã‚ã‚Šã€ç¨¼åƒã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ã€‚

```bash:terminal
sudo systemctl status minio.service
journalctl -f -u minio.service
```

ã‚µãƒ¼ãƒãƒ¼ãƒ—ãƒ­ã‚»ã‚¹ãŒæ¥ç¶šã—åŒæœŸã—ã¦ã„ã‚‹é–“ã€MinIOã¯é‡è¦ã§ãªã„è­¦å‘Šã‚’å¤šãè¨˜éŒ²ã™ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã‚‰ã®è­¦å‘Šã¯é€šå¸¸ä¸€æ™‚çš„ãªã‚‚ã®ã§ã€ãƒ‡ãƒ—ãƒ­ã‚¤ãŒã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã«ãªã‚‹ã¨è§£æ±ºã•ã‚Œã‚‹ã€‚

journalctl ã®å‡ºåŠ›ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

```
Status:         1 Online, 0 Offline.
API: http://192.168.2.100:9000  http://127.0.0.1:9000
RootUser: myminioadmin
RootPass: minio-secret-key-change-me
Console: http://192.168.2.100:9090 http://127.0.0.1:9090
RootUser: myminioadmin
RootPass: minio-secret-key-change-me

Command-line: https://min.io/docs/minio/linux/reference/minio-mc.html
   $ mc alias set myminio http://10.0.2.100:9000 myminioadmin minio-secret-key-change-me

Documentation: https://min.io/docs/minio/linux/index.html
```

APIãƒ–ãƒ­ãƒƒã‚¯ã«ã¯ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒMinIO S3 APIã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã¨ãƒãƒ¼ãƒˆãŒä¸€è¦§è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚Consoleãƒ–ãƒ­ãƒƒã‚¯ã«ã¯ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒMinIO Webã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã¨ãƒãƒ¼ãƒˆãŒä¸€è¦§è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚


