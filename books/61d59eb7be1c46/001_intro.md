---
title: "Gitブランチ戦略とは"
---

## はじめに

Gitのブランチの操作やコマンド等については、さまざまな書籍やサイトで与えられている。  
しかしながら、実際にGitを使った開発となると、具体的にどのように使えばよいのかがわからないとなる人も多いと思われる（少なくとも私がそうでした…）  
Gitは使えば馴れていくのを実感できるツールではあるものの、チームとして活用されていない環境や自身が馴れないうちはなかなか手が出にくい。
そういうのもあり、個人開発という小さな単位でGitというものの便利さに触れられる仕組みがあれば、もっとGitに触れることに抵抗がなくなるのではないかと感じるようになった。

このような経緯から、この記事では、以下についての記述を行う。

* Gitにおけるブランチ戦略・ワークフローの概説
* 個人開発に向いたワークフローの提案とそのハンズオン

原則として、Gitの基本的な特徴や操作については、さまざまな書籍やWeb教材が存在することから、必要最小限に絞っての表記とし、あくまでワークフローに特化した解説を行う。

なお、本記事におけるリモートリポジトリとしては、以下に対応する。

* GitHub
* GitLab

もし、本記事における不明点やGitの基本について学びなおしたいというのであれば、以下のWeb教材を参照されたい。

* [Pro Git - Book](https://git-scm.com/book/ja/v2)
* [GitHub演習 by kaityo256](https://github.com/kaityo256/github?tab=readme-ov-file)
* [サル先生のGit入門](https://backlog.com/ja/git-tutorial/)


## ブランチ戦略

Gitには、以下の特徴による柔軟なブランチ運用が可能である。

* 軽量かつ高速
* 分散型バージョン管理でオフラインでもブランチ操作が可能
* 完全な履歴管理

この特徴を生かしたブランチ運用の方法論、すなわち開発ワークフローというものがさまざま提唱されてきた。  
あらかじめブランチの運用ルールを決めて開発をすすめることや、その際の運用ルールのことを「ブランチ戦略」と言う。  

ブランチ戦略のなかでもとくに有名なものを以下に挙げる。

* Git-Flow
* GitHub Flow
* GitLab Flow
* Feature Branch Workflow

結論からいうと、本記事ではGitHub Flowに関する詳しい解説およびハンズオンの提供を行う。  
そのまえに、メジャーなブランチ戦略であるGit-Flowに関する解説をかんたんに与える。


### Git-Flow

**Git-Flow**とは、2011年にNVIEが書いたブログの記事である["A successful Git branching model"](https://nvie.com/posts/a-successful-git-branching-model/)において提唱された戦略である。

実装する内容（機能、バグフィックス etc）とフェーズごとに細かくブランチを切る戦略である。
ブログ記事にあるGit-Flowのコミットグラフを示す画像を以下に示す。

![Git-Flowのサンプル](/images/61d59eb7be1c46/20230802094004.png)

画像を見るだけで、大規模な開発で用いやすい構成になっているのは直感的に理解できるであろう。  
小規模で使える戦略として、最も一般的に解説されるのがGitHub Flowであり、以降ではGitHub Flowについて解説を行う。

## GitHub Flow

**GitHub Flow**とは、GitHubで開発を進めるさいによく用いられるワークフローであり、GitHub社もGitHub開発のさいにこのワークフローを使っているとのこと。

GitHub Flowの特徴は、ブランチをメイン（`master`）と作業用（`feature`）の2種類のみを用いてワークフローを構成するところにある。  
明瞭な構成で使いやすく、小規模～大規模の開発まで迅速に開発をすすめたいときに適している。
それゆえに、GitHub Flowは簡単に扱うことが可能なこともあり、GitHub初心者やプログラマー以外のユーザーでも扱いやすいものであると思われる。

### GitHub Flowの6つのルール

GitHub Flowを具体的に言うと、以下の6つのルールを満たすワークフローであるといわれている。

1. **masterブランチ常にデプロイ可能である**  
GitHub Flowではmasterブランチへマージする場合、すぐにデプロイすることを求めている。  
このルールを前提に慎重にテスト・レビュー・マージすることが必要である。
2. **masterから説明的なブランチを作成する**  
機能追加やバグ修正など、なんらかの作業を行うときは、必ずmasterブランチから説明的なブランチ（作業用ブランチ）を作成する。  
そうして作業用ブランチで開発作業を行い、最終的にmasterブランチへマージされるようにする。  
なお、作業用ブランチの名称に決まりはないが、どのような作業をしているかがわかりやすい名前をつけることが推奨される。
1. **名前をつけたブランチに定期的にプッシュする**
ローカルリポジトリから定期的にリモートリポジトリへプッシュする。
開発の内容をスムーズに他メンバーと共有することにより、変更箇所が衝突するなどのトラブルを防ぐことを目的とする。
1. **プルリクエストを常時活用する**  
フィードバックやアドバイスが欲しいときや、masterブランチへマージするときなどは必ずプルリクエストを作成しレビューを求める。  
これにより、確実にレビューが行えるようになる。
1. **masterへのマージはプルリクエストが承認された後だけ**  
masterブランチへマージする際は、必ずプルリクエストを行うことを求める。  
これにより、masterブランチを、常にデプロイ可能な状態に保持することが可能となる。
1. **masterへのマージが完了したら直ちにデプロイする**  
デプロイせずに放置してしまうと、他の開発者とのマージが衝突する可能性が生じるため、直ちにデプロイすることが求められる。  


### マージとブランチの削除

GitHub Flowにおいて、masterブランチへマージされたあと、マージ元のブランチは削除を行うのが一般的である。  
それを行うメリットとして、一般的に以下が挙げられる。

* リポジトリをクリーンな状態を保つことができる。  
これにより、現在アクティブな作業や進行中の機能が明確になる。
* リソースの節約することができる。　　
特に大規模なプロジェクトでは、ブランチごとに多くのリソースが消費されることがあることも意識しておきたい。
* 古いコードが誤って使用されるリスクを減らすことができる。  
不要なブランチが残っていると、誤ってそれらをベースに新しい作業を始める可能性がある。

一方で、そのブランチで行われた詳細な作業履歴を追跡することや、削除したブランチを再利用する必要が生じた場合における対処が困難になることが挙げられる。

これらを考慮して、状況によってはマージ済みのブランチを残す必要がある場合もある。  
例えば、リリース用のブランチや、長期的なメンテナンスが必要なブランチなどは残す方針を取られることが多々あり、このような運用を行う場合は、チームで方針を決めて適切に管理することが重要である。

一般的には、マージ済みのブランチを削除することがGitHub Flowの推奨される方法であり、多くのチームやプロジェクトで実践されているが、プロジェクトの特性や要件に応じて、柔軟に対応することも大切である。

